{"ast":null,"code":"import React,{useState,useEffect}from'react';import axios from'axios';import WelcomeScreen from'./components/WelcomeScreen';import NameFormScreen from'./components/NameFormScreen';import HoldingScreen from'./components/HoldingScreen';import StartingScreen from'./components/StartingScreen';import GameState from'./components/GameState';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";function App(){const[currentScreen,setCurrentScreen]=useState('welcome');const[playerName,setPlayerName]=useState('');const[isReady,setIsReady]=useState(false);const[userList,setUserList]=useState([]);const[eventSource,setEventSource]=useState(null);const joinGame=()=>{setCurrentScreen('nameForm');};const submitName=name=>{axios.post('/submit-name',{displayName:name}).then(response=>{setPlayerName(name);setUserList(response.data.users);setCurrentScreen('holding');// Set up SSE connection after user has entered their display name\nconst newEventSource=new EventSource(`/events?displayName=${name}`);newEventSource.onmessage=event=>{const data=JSON.parse(event.data);if(data.type==='userList'){setUserList(data.users);}};setEventSource(newEventSource);}).catch(error=>{console.error('Error submitting name:',error);});};const setReady=()=>{axios.post('/set-ready',{displayName:playerName}).then(response=>{setIsReady(true);setCurrentScreen('starting');}).catch(error=>{console.error('Error setting ready status:',error);});};useEffect(()=>{// Clean up the EventSource connection when the component unmounts\nreturn()=>{if(eventSource){eventSource.close();}};},[eventSource]);return/*#__PURE__*/_jsxs(\"div\",{children:[currentScreen==='welcome'&&/*#__PURE__*/_jsx(WelcomeScreen,{joinGame:joinGame}),currentScreen==='nameForm'&&/*#__PURE__*/_jsx(NameFormScreen,{onSubmit:submitName}),currentScreen==='holding'&&/*#__PURE__*/_jsx(HoldingScreen,{message:\"Waiting for players...\",userList:userList,onReady:setReady}),currentScreen==='starting'&&/*#__PURE__*/_jsx(StartingScreen,{}),isReady&&/*#__PURE__*/_jsx(GameState,{})]});}export default App;","map":{"version":3,"names":["React","useState","useEffect","axios","WelcomeScreen","NameFormScreen","HoldingScreen","StartingScreen","GameState","jsx","_jsx","jsxs","_jsxs","App","currentScreen","setCurrentScreen","playerName","setPlayerName","isReady","setIsReady","userList","setUserList","eventSource","setEventSource","joinGame","submitName","name","post","displayName","then","response","data","users","newEventSource","EventSource","onmessage","event","JSON","parse","type","catch","error","console","setReady","close","children","onSubmit","message","onReady"],"sources":["/Users/baijianqing/VSC/The-Retro-Retro-Game/frontend/src/App.js"],"sourcesContent":["import React, { useState, useEffect } from 'react';\nimport axios from 'axios';\nimport WelcomeScreen from './components/WelcomeScreen';\nimport NameFormScreen from './components/NameFormScreen';\nimport HoldingScreen from './components/HoldingScreen';\nimport StartingScreen from './components/StartingScreen';\nimport GameState from './components/GameState';\n\nfunction App() {\n    const [currentScreen, setCurrentScreen] = useState('welcome');\n    const [playerName, setPlayerName] = useState('');\n    const [isReady, setIsReady] = useState(false);\n    const [userList, setUserList] = useState([]);\n    const [eventSource, setEventSource] = useState(null);\n\n    const joinGame = () => {\n        setCurrentScreen('nameForm');\n    };\n\n    const submitName = (name) => {\n        axios.post('/submit-name', { displayName: name })\n            .then(response => {\n                setPlayerName(name);\n                setUserList(response.data.users);\n                setCurrentScreen('holding');\n\n                // Set up SSE connection after user has entered their display name\n                const newEventSource = new EventSource(`/events?displayName=${name}`);\n                newEventSource.onmessage = (event) => {\n                    const data = JSON.parse(event.data);\n                    if (data.type === 'userList') {\n                        setUserList(data.users);\n                    }\n                };\n                setEventSource(newEventSource);\n            })\n            .catch(error => {\n                console.error('Error submitting name:', error);\n            });\n    };\n\n    const setReady = () => {\n        axios.post('/set-ready', { displayName: playerName })\n            .then(response => {\n                setIsReady(true);\n                setCurrentScreen('starting');\n            })\n            .catch(error => {\n                console.error('Error setting ready status:', error);\n            });\n    };\n\n    useEffect(() => {\n        // Clean up the EventSource connection when the component unmounts\n        return () => {\n            if (eventSource) {\n                eventSource.close();\n            }\n        };\n    }, [eventSource]);\n\n    return (\n        <div>\n            {currentScreen === 'welcome' && <WelcomeScreen joinGame={joinGame} />}\n            {currentScreen === 'nameForm' && <NameFormScreen onSubmit={submitName} />}\n            {currentScreen === 'holding' && <HoldingScreen message=\"Waiting for players...\" userList={userList} onReady={setReady} />}\n            {currentScreen === 'starting' && <StartingScreen />}\n            {isReady && <GameState />}\n        </div>\n    );\n}\n\nexport default App;"],"mappings":"AAAA,MAAO,CAAAA,KAAK,EAAIC,QAAQ,CAAEC,SAAS,KAAQ,OAAO,CAClD,MAAO,CAAAC,KAAK,KAAM,OAAO,CACzB,MAAO,CAAAC,aAAa,KAAM,4BAA4B,CACtD,MAAO,CAAAC,cAAc,KAAM,6BAA6B,CACxD,MAAO,CAAAC,aAAa,KAAM,4BAA4B,CACtD,MAAO,CAAAC,cAAc,KAAM,6BAA6B,CACxD,MAAO,CAAAC,SAAS,KAAM,wBAAwB,CAAC,OAAAC,GAAA,IAAAC,IAAA,CAAAC,IAAA,IAAAC,KAAA,yBAE/C,QAAS,CAAAC,GAAGA,CAAA,CAAG,CACX,KAAM,CAACC,aAAa,CAAEC,gBAAgB,CAAC,CAAGd,QAAQ,CAAC,SAAS,CAAC,CAC7D,KAAM,CAACe,UAAU,CAAEC,aAAa,CAAC,CAAGhB,QAAQ,CAAC,EAAE,CAAC,CAChD,KAAM,CAACiB,OAAO,CAAEC,UAAU,CAAC,CAAGlB,QAAQ,CAAC,KAAK,CAAC,CAC7C,KAAM,CAACmB,QAAQ,CAAEC,WAAW,CAAC,CAAGpB,QAAQ,CAAC,EAAE,CAAC,CAC5C,KAAM,CAACqB,WAAW,CAAEC,cAAc,CAAC,CAAGtB,QAAQ,CAAC,IAAI,CAAC,CAEpD,KAAM,CAAAuB,QAAQ,CAAGA,CAAA,GAAM,CACnBT,gBAAgB,CAAC,UAAU,CAAC,CAChC,CAAC,CAED,KAAM,CAAAU,UAAU,CAAIC,IAAI,EAAK,CACzBvB,KAAK,CAACwB,IAAI,CAAC,cAAc,CAAE,CAAEC,WAAW,CAAEF,IAAK,CAAC,CAAC,CAC5CG,IAAI,CAACC,QAAQ,EAAI,CACdb,aAAa,CAACS,IAAI,CAAC,CACnBL,WAAW,CAACS,QAAQ,CAACC,IAAI,CAACC,KAAK,CAAC,CAChCjB,gBAAgB,CAAC,SAAS,CAAC,CAE3B;AACA,KAAM,CAAAkB,cAAc,CAAG,GAAI,CAAAC,WAAW,CAAC,uBAAuBR,IAAI,EAAE,CAAC,CACrEO,cAAc,CAACE,SAAS,CAAIC,KAAK,EAAK,CAClC,KAAM,CAAAL,IAAI,CAAGM,IAAI,CAACC,KAAK,CAACF,KAAK,CAACL,IAAI,CAAC,CACnC,GAAIA,IAAI,CAACQ,IAAI,GAAK,UAAU,CAAE,CAC1BlB,WAAW,CAACU,IAAI,CAACC,KAAK,CAAC,CAC3B,CACJ,CAAC,CACDT,cAAc,CAACU,cAAc,CAAC,CAClC,CAAC,CAAC,CACDO,KAAK,CAACC,KAAK,EAAI,CACZC,OAAO,CAACD,KAAK,CAAC,wBAAwB,CAAEA,KAAK,CAAC,CAClD,CAAC,CAAC,CACV,CAAC,CAED,KAAM,CAAAE,QAAQ,CAAGA,CAAA,GAAM,CACnBxC,KAAK,CAACwB,IAAI,CAAC,YAAY,CAAE,CAAEC,WAAW,CAAEZ,UAAW,CAAC,CAAC,CAChDa,IAAI,CAACC,QAAQ,EAAI,CACdX,UAAU,CAAC,IAAI,CAAC,CAChBJ,gBAAgB,CAAC,UAAU,CAAC,CAChC,CAAC,CAAC,CACDyB,KAAK,CAACC,KAAK,EAAI,CACZC,OAAO,CAACD,KAAK,CAAC,6BAA6B,CAAEA,KAAK,CAAC,CACvD,CAAC,CAAC,CACV,CAAC,CAEDvC,SAAS,CAAC,IAAM,CACZ;AACA,MAAO,IAAM,CACT,GAAIoB,WAAW,CAAE,CACbA,WAAW,CAACsB,KAAK,CAAC,CAAC,CACvB,CACJ,CAAC,CACL,CAAC,CAAE,CAACtB,WAAW,CAAC,CAAC,CAEjB,mBACIV,KAAA,QAAAiC,QAAA,EACK/B,aAAa,GAAK,SAAS,eAAIJ,IAAA,CAACN,aAAa,EAACoB,QAAQ,CAAEA,QAAS,CAAE,CAAC,CACpEV,aAAa,GAAK,UAAU,eAAIJ,IAAA,CAACL,cAAc,EAACyC,QAAQ,CAAErB,UAAW,CAAE,CAAC,CACxEX,aAAa,GAAK,SAAS,eAAIJ,IAAA,CAACJ,aAAa,EAACyC,OAAO,CAAC,wBAAwB,CAAC3B,QAAQ,CAAEA,QAAS,CAAC4B,OAAO,CAAEL,QAAS,CAAE,CAAC,CACxH7B,aAAa,GAAK,UAAU,eAAIJ,IAAA,CAACH,cAAc,GAAE,CAAC,CAClDW,OAAO,eAAIR,IAAA,CAACF,SAAS,GAAE,CAAC,EACxB,CAAC,CAEd,CAEA,cAAe,CAAAK,GAAG","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}